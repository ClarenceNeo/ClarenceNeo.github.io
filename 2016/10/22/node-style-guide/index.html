<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 代码风格指南（Node.js） · Clarence</title><meta name="description" content="代码风格指南（Node.js） - Clarence Neo"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="Clarence"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/clarenceneo" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/ClarenceNeo" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">代码风格指南（Node.js）</h1><div class="post-info">Oct 22, 2016</div><div class="post-content"><h2 id="2空格缩进"><a href="#2空格缩进" class="headerlink" title="2空格缩进"></a>2空格缩进</h2><p>使用2个空格而不是 tab 来进行代码缩进，同时绝对不要混用空格和 tab 。</p>
<p>Sublime Text 2 设置(perfernces &gt; Settings - User)：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&quot;tab_size&quot;: 2,</div><div class="line">&quot;translate_tabs_to_spaces&quot;: true</div></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="换行"><a href="#换行" class="headerlink" title="换行"></a>换行</h2><p>使用 UNIX 风格的换行符 (<code>\n</code>)，同时在每个文件的结尾添加一个换行符。 Windows 风格的换行符 (<code>\r\n</code>) 是绝对禁止出现在任何项目中的。</p>
<p>Sublime Text 2 设置(perfernces &gt; Settings - User)：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&quot;default_line_ending&quot;: &quot;unix&quot;</div></pre></td></tr></table></figure>
<h2 id="去除行末尾的多余空格"><a href="#去除行末尾的多余空格" class="headerlink" title="去除行末尾的多余空格"></a>去除行末尾的多余空格</h2><p>就像吃完饭要刷牙一样，在提交 (commit) 代码之前你需要清理掉所有的不必要的空格。</p>
<p>Sublime Text2 设置(perfernces &gt; Settings - User)：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&quot;trim_trailing_white_space_on_save&quot;: true</div></pre></td></tr></table></figure>
<h2 id="使用分号"><a href="#使用分号" class="headerlink" title="使用分号"></a>使用分号</h2><p>是否使用分号，在社区争论已久。 isaac 也写过一篇讨论的<a href="http://blog.izs.me/post/2353458699/an-open-letter-to-javascript-leaders-regarding" target="_blank" rel="external">文章</a>， 但是，当可以用廉价的语法来消除一些可能引入的错误的时候，请当一个保守派。</p>
<h2 id="每行80个字符"><a href="#每行80个字符" class="headerlink" title="每行80个字符"></a>每行80个字符</h2><p>限制你每行代码不超过80个字符。尽管现在的显示器越来越大，但是你的大脑并没有变大，并且你还可以把你的大显示器切分成多屏来显示。</p>
<p>Sublime Text 2 设置(perfernces &gt; Settings - User)：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&quot;rulers&quot;: [80]</div></pre></td></tr></table></figure>
<p>多屏：<code>view &gt; Layout &gt; Columns 2</code></p>
<h2 id="使用单引号"><a href="#使用单引号" class="headerlink" title="使用单引号"></a>使用单引号</h2><p>除非编写.json文件，其他时候都请用单引号包裹字符串。</p>
<p>Right:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var foo = &apos;bar&apos;;</div></pre></td></tr></table></figure>
<p>Wrong:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var foo = &quot;bar&quot;;</div></pre></td></tr></table></figure>
<h2 id="大括号位置"><a href="#大括号位置" class="headerlink" title="大括号位置"></a>大括号位置</h2><p>请把你的所有的左大括号都放在语句开始的这一行。</p>
<p>Right:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">if (true) &#123;</div><div class="line">  console.log(&apos;winning&apos;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Wrong:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">if (true)</div><div class="line">&#123;</div><div class="line">  console.log(&apos;losing&apos;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>同时，请注意在条件判断前后都添加一个空格。</p>
<h2 id="每个变量声明都带一个-var"><a href="#每个变量声明都带一个-var" class="headerlink" title="每个变量声明都带一个 var"></a>每个变量声明都带一个 var</h2><p>每个变量声明都带一个 var ，这样删除或者调整变量声明的顺序会更加容易。 不要把变量都声明在最前面，而是声明在它最有意义的地方。</p>
<p>Right:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">var keys   = [&apos;foo&apos;, &apos;bar&apos;];</div><div class="line">var values = [23, 42];</div><div class="line"></div><div class="line">var object = &#123;&#125;;</div><div class="line">while (items.length) &#123;</div><div class="line">  var key = keys.pop();</div><div class="line">  object[key] = values.pop();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Wrong:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">var keys = [&apos;foo&apos;, &apos;bar&apos;],</div><div class="line">    values = [23, 42],</div><div class="line">    object = &#123;&#125;,</div><div class="line">    key;</div><div class="line"></div><div class="line">while (items.length) &#123;</div><div class="line">  key = keys.pop();</div><div class="line">  object[key] = values.pop();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="变量、属性和函数名都采用小驼峰"><a href="#变量、属性和函数名都采用小驼峰" class="headerlink" title="变量、属性和函数名都采用小驼峰"></a>变量、属性和函数名都采用小驼峰</h2><p>变量、属性和函数的命名风格都需要遵循小驼峰风格。 同时所有的命名都是有意义的。 尽量避免用单字符变量和少见单词来命名。</p>
<p>Right:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var adminUser = db.query(&apos;SELECT * FROM users ...&apos;);</div></pre></td></tr></table></figure>
<p>Wrong:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">var admin_user = db.query(&apos;SELECT * FROM users ...&apos;);</div><div class="line">var a = db.query(&apos;SELECT * FROM users ...&apos;);</div></pre></td></tr></table></figure>
<h2 id="类名采用大驼峰"><a href="#类名采用大驼峰" class="headerlink" title="类名采用大驼峰"></a>类名采用大驼峰</h2><p>类名都采用大驼峰风格来命名。</p>
<p>Right:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">function BankAccount() &#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Wrong:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">function bank_Account() &#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="用大写来标识常量"><a href="#用大写来标识常量" class="headerlink" title="用大写来标识常量"></a>用大写来标识常量</h2><p>常量变量和对象的静态常量属性都需要特殊表明，通过全部大写的方式来表明。</p>
<p>尽管 Node.js / V8 支持 mozilla 的 const 关键字， 但是不幸的是，对象的属性并不支持这个关键字，而且 const 没有包含于任何一个 ECMA 规范中。</p>
<p>Right:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">var SECOND = 1 * 1000;</div><div class="line"></div><div class="line">function File() &#123;</div><div class="line">&#125;</div><div class="line">File.FULL_PERMISSIONS = 0777;</div></pre></td></tr></table></figure>
<p>Wrong:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">const SECOND = 1 * 1000;</div><div class="line"></div><div class="line">function File() &#123;</div><div class="line">&#125;</div><div class="line">File.fullPermissions = 0777;</div></pre></td></tr></table></figure>
<h2 id="对象、数组的创建"><a href="#对象、数组的创建" class="headerlink" title="对象、数组的创建"></a>对象、数组的创建</h2><p>使用尾随逗号，尽量用一行来声明，只有在编译器不接受的情况下才把对象的 key 用单引号包裹。 使用字面表达式，用<code>{}, []</code>代替 <code>new Array, new Object</code>。</p>
<p>Right:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">var a = [&apos;hello&apos;, &apos;world&apos;];</div><div class="line">var b = &#123;</div><div class="line">  good: &apos;code&apos;,</div><div class="line">  &apos;is generally&apos;: &apos;pretty&apos;,</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>Wrong:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">var a = [</div><div class="line">  &apos;hello&apos;, &apos;world&apos;</div><div class="line">];</div><div class="line">var b = &#123;&quot;good&quot;: &apos;code&apos;</div><div class="line">        , is generally: &apos;pretty&apos;</div><div class="line">        &#125;;</div></pre></td></tr></table></figure>
<h2 id="使用-比较符"><a href="#使用-比较符" class="headerlink" title="使用 === 比较符"></a>使用 === 比较符</h2><p>写代码并不是在背这些 <a href="https://developer.mozilla.org/en/JavaScript/Reference/Operators/Comparison_Operators" target="_blank" rel="external">stupid rules</a> 。使用 === 操作符来进行比较操作，它会完全按照你的期望来执行。</p>
<p>Right:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">var a = 0;</div><div class="line">if (a === &apos;&apos;) &#123;</div><div class="line">  console.log(&apos;winning&apos;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Wrong:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">var a = 0;</div><div class="line">if (a == &apos;&apos;) &#123;</div><div class="line">  console.log(&apos;losing&apos;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="三元操作符分多行"><a href="#三元操作符分多行" class="headerlink" title="三元操作符分多行"></a>三元操作符分多行</h2><p>三元操作符不应该写在一行，将它分割到多行。</p>
<p>Right:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var foo = (a === b)</div><div class="line">  ? 1</div><div class="line">  : 2;</div></pre></td></tr></table></figure>
<p>Wrong:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var foo = (a === b) ? 1 : 2;</div></pre></td></tr></table></figure>
<h2 id="不要扩展内建类型"><a href="#不要扩展内建类型" class="headerlink" title="不要扩展内建类型"></a>不要扩展内建类型</h2><p>不要扩展 javascript 内建对象的方法。将来的你会感谢你这个做法的。</p>
<p>Right:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">var a = [];</div><div class="line">if (!a.length) &#123;</div><div class="line">  console.log(&apos;winning&apos;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Wrong:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Array.prototype.empty = function() &#123;</div><div class="line">  return !this.length;</div><div class="line">&#125;</div><div class="line"></div><div class="line">var a = [];</div><div class="line">if (a.empty()) &#123;</div><div class="line">  console.log(&apos;losing&apos;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="使用有意义的判断条件"><a href="#使用有意义的判断条件" class="headerlink" title="使用有意义的判断条件"></a>使用有意义的判断条件</h2><p>所有复杂的条件判断都需要赋予一个有意义的名字或者方法。</p>
<p>Right:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">var isValidPassword = password.length &gt;= 4 &amp;&amp; /^(?=.*\d).&#123;4,&#125;$/.test(password);</div><div class="line"></div><div class="line">if (isValidPassword) &#123;</div><div class="line">  console.log(&apos;winning&apos;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Wrong:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">if (password.length &gt;= 4 &amp;&amp; /^(?=.*\d).&#123;4,&#125;$/.test(password)) &#123;</div><div class="line">  console.log(&apos;losing&apos;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="写精简的函数"><a href="#写精简的函数" class="headerlink" title="写精简的函数"></a>写精简的函数</h2><p>保持你的函数尽可能的精简。 一个好的函数应该能够在幻灯片上一屏显示，并且让坐在教室最后一排的人看清楚。 别再去数你的每一个函数并控制在15行以内了。</p>
<h2 id="尽早的从函数中返回"><a href="#尽早的从函数中返回" class="headerlink" title="尽早的从函数中返回"></a>尽早的从函数中返回</h2><p>为了避免深入嵌套的 if 语句，请尽早的从函数中返回。</p>
<p>Right:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">function isPercentage(val) &#123;</div><div class="line">  if (val &lt; 0) &#123;</div><div class="line">    return false;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  if (val &gt; 100) &#123;</div><div class="line">    return false;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  return true;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Wrong:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">function isPercentage(val) &#123;</div><div class="line">  if (val &gt;= 0) &#123;</div><div class="line">    if (val &lt; 100) &#123;</div><div class="line">      return true;</div><div class="line">    &#125; else &#123;</div><div class="line">      return false;</div><div class="line">    &#125;</div><div class="line">  &#125; else &#123;</div><div class="line">    return false;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>针对这个示例，甚至可以进一步精简优化：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">function isPercentage(val) &#123;</div><div class="line">  var isInRange = (val &gt;= 0 &amp;&amp; val &lt;= 100);</div><div class="line">  return isInRange;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="给你的闭包命名"><a href="#给你的闭包命名" class="headerlink" title="给你的闭包命名"></a>给你的闭包命名</h2><p>请尽量给你的闭包、匿名函数命名。 这让人知道你在意这个函数，更重要的是，这将会产生可读性更好的堆栈跟踪和CPU调用信息等。</p>
<p>Right:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">req.on(&apos;end&apos;, function onEnd() &#123;</div><div class="line">  console.log(&apos;winning&apos;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>Wrong:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">req.on(&apos;end&apos;, function() &#123;</div><div class="line">  console.log(&apos;losing&apos;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="不要嵌套闭包"><a href="#不要嵌套闭包" class="headerlink" title="不要嵌套闭包"></a>不要嵌套闭包</h2><p>使用闭包，但是不要嵌套他们，否则你的代码将会一团糟。</p>
<p>Right:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">setTimeout(function() &#123;</div><div class="line">  client.connect(afterConnect);</div><div class="line">&#125;, 1000);</div><div class="line"></div><div class="line">function afterConnect() &#123;</div><div class="line">  console.log(&apos;winning&apos;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Wrong:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">setTimeout(function() &#123;</div><div class="line">  client.connect(function() &#123;</div><div class="line">    console.log(&apos;losing&apos;);</div><div class="line">  &#125;);</div><div class="line">&#125;, 1000);</div></pre></td></tr></table></figure>
<h2 id="使用单行注释风格"><a href="#使用单行注释风格" class="headerlink" title="使用单行注释风格"></a>使用单行注释风格</h2><p>不管是单行注释还是多行注释，都使用 <code>//</code> 。 同时请尝试在更高层次来编写注释（解释函数整体的思路）， 只在解释一些难以理解代码的时候添加注释，而不是给一些琐碎的东西加上注释。</p>
<p>Right:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">// &apos;ID_SOMETHING=VALUE&apos; -&gt; [&apos;ID_SOMETHING=VALUE&apos;&apos;, &apos;SOMETHING&apos;, &apos;VALUE&apos;]</div><div class="line">var matches = item.match(/ID_([^\n]+)=([^\n]+)/));</div><div class="line"></div><div class="line">// This function has a nasty side effect where a failure to increment a</div><div class="line">// redis counter used for statistics will cause an exception. This needs</div><div class="line">// to be fixed in a later iteration.</div><div class="line">function loadUser(id, cb) &#123;</div><div class="line">  // ...</div><div class="line">&#125;</div><div class="line"></div><div class="line">var isSessionValid = (session.expires &lt; Date.now());</div><div class="line">if (isSessionValid) &#123;</div><div class="line">  // ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Wrong:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">// Execute a regex</div><div class="line">var matches = item.match(/ID_([^\n]+)=([^\n]+)/));</div><div class="line"></div><div class="line">// Usage: loadUser(5, function() &#123; ... &#125;)</div><div class="line">function loadUser(id, cb) &#123;</div><div class="line">  // ...</div><div class="line">&#125;</div><div class="line"></div><div class="line">// Check if the session is valid</div><div class="line">var isSessionValid = (session.expires &lt; Date.now());</div><div class="line">// If the session is valid</div><div class="line">if (isSessionValid) &#123;</div><div class="line">  // ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Object-freeze-Object-preventExtensions-Object-seal-with-eval"><a href="#Object-freeze-Object-preventExtensions-Object-seal-with-eval" class="headerlink" title="Object.freeze, Object.preventExtensions, Object.seal, with, eval"></a>Object.freeze, Object.preventExtensions, Object.seal, with, eval</h2><p>这一堆屎一样的东西，你永远都不会需要他们。</p>
<h2 id="Getters-和-Setters"><a href="#Getters-和-Setters" class="headerlink" title="Getters 和 Setters"></a>Getters 和 Setters</h2><p>不要使用 setters ，他们会引发一些使用你的代码的人无法解决的问题。 当没有<a href="http://en.wikipedia.org/wiki/Side_effect_(computer_science" target="_blank" rel="external">副作用</a>)的时候，可以使用 getters，例如提供一个集合类的长度属性的时候。</p>
<h2 id="异步回调函数"><a href="#异步回调函数" class="headerlink" title="异步回调函数"></a>异步回调函数</h2><p>Node 的异步回调函数的第一个参数应该是错误指示，只有这样才能够享受许多流程控制模块的福利。</p>
<p>Right:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">function cb(err, data , ...) &#123;...&#125;</div></pre></td></tr></table></figure>
<p>Wrong:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">function cb(data, ...) &#123;...&#125;</div></pre></td></tr></table></figure>
<h2 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h2><p>尽管有许多的方法来实现继承，但是最为推荐的是 Node 的标准写法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">function Socket(options) &#123;</div><div class="line">  // ...</div><div class="line">  stream.Stream.call(this);</div><div class="line">  // ...</div><div class="line">&#125;</div><div class="line"></div><div class="line">util.inherits(Socket, stream.Stream);</div></pre></td></tr></table></figure>
<h2 id="文件命名"><a href="#文件命名" class="headerlink" title="文件命名"></a>文件命名</h2><p>单词之间使用 <code>_</code> underscore 来分割，如果你不想暴露某个文件给用户，你也可以用 _ 来开头</p>
<p>Right:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">child_process.js</div><div class="line">string_decoder.js</div><div class="line">_linklist.js</div></pre></td></tr></table></figure>
<p>Wrong:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">childProcess.js</div><div class="line">stringDecoder.js</div></pre></td></tr></table></figure>
<h2 id="空格"><a href="#空格" class="headerlink" title="空格"></a>空格</h2><p>在所有的操作符前后都添加空格，<code>function</code> 关键字后面添加空格</p>
<p>Right:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var add = function (a, b) &#123;</div><div class="line">  return a + b;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>Wrong:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var add=function(a,b)&#123;</div><div class="line">  return a+b;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="入乡随俗"><a href="#入乡随俗" class="headerlink" title="入乡随俗"></a>入乡随俗</h2><p>给别人的项目提交 pull request 的时候，要注意遵循项目的编码规范，保持项目编码风格的统一。</p>
</div></article></div></main><footer><div class="paginator"><a href="/2017/02/09/CSS-居中布局/" class="prev">上一篇</a><a href="/2016/10/21/document-style-guide3/" class="next">下一篇</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'clarenceneo';
var disqus_identifier = '2016/10/22/node-style-guide/';
var disqus_title = '代码风格指南（Node.js）';
var disqus_url = 'http://yoursite.com/2016/10/22/node-style-guide/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//clarenceneo.disqus.com/count.js" async></script><div class="copyright"><p>© 2016 - 2017 <a href="http://yoursite.com">Clarence Neo</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>